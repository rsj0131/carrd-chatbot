async function sendMessage() {
    const inputElement = document.getElementById("message");
    const message = inputElement.value;

    if (!message.trim()) return;

    const messagesDiv = document.getElementById("messages");

    // Add user message
    const userMessageContainer = document.createElement("div");
    userMessageContainer.className = "message-container user";

    const userMessage = document.createElement("div");
    userMessage.className = "user-message";
    userMessage.innerText = message;

    userMessageContainer.appendChild(userMessage);
    messagesDiv.appendChild(userMessageContainer);

    // Clear the input field
    inputElement.value = "";

    // Scroll to the bottom
    messagesDiv.scrollTop = messagesDiv.scrollHeight;

    // Add typing indicator
    const typingIndicator = document.createElement("div");
    typingIndicator.className = "message-container bot typing-indicator";
    typingIndicator.innerHTML = `
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
    `;
    messagesDiv.appendChild(typingIndicator);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;

    try {
        const response = await fetch("https://carrd-chatbot.vercel.app/api/reply", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message }),
        });

        const data = await response.json();

        // Remove typing indicator
        typingIndicator.remove();

        // Add bot reply
        const botMessageContainer = document.createElement("div");
        botMessageContainer.className = "message-container bot";

        const botMessage = document.createElement("div");
        botMessage.className = "bot-message";
        botMessage.innerText = data.reply || "Error: " + data.error;

        botMessageContainer.appendChild(botMessage);
        messagesDiv.appendChild(botMessageContainer);

        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    } catch (error) {
        // Handle errors
        typingIndicator.remove();

        const botMessageContainer = document.createElement("div");
        botMessageContainer.className = "message-container bot";

        const botMessage = document.createElement("div");
        botMessage.className = "bot-message";
        botMessage.innerText = "Error: Unable to connect to the server.";

        botMessageContainer.appendChild(botMessage);
        messagesDiv.appendChild(botMessageContainer);

        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }
}
